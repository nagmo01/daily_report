# 2023/12/18の日報


## 取り組んだこと
- カートのテーブルを作り直した。
- マイグレーションやスキーマファイルなどについて復習した。

## わかったこと
- Cart,CartItems,Itemsという３つのテーブルの構成にする方法正規化的にが適切っぽい


## 次やること
- RailsのEC課題のカート機能のモデル、テーブルの構成を変更する。
- 現場rails chap3読む
- 現場rails chap4読む
- チェックアウト機能に入る

## 感じたこと

## 学習時間
- TODAY: 5h
- TOTAL: 502.5h



## 今日の学習メモ

### 感じたこと
model、テーブル、マイグレーションファイル、スキーマあたりの知識が圧倒的に足りていないように感じるのでインプットで補強したい。


### こちら、一つのCartに複数のItemが紐づく形にしましょう
PRの修正。
レビューで言われているCartItemsは現在自分が定義しているCartテーブルの役割のことで、Cartというものはsession_idごとにCartを紐づけるという役割のテーブルを追加で用意する。これはユーザー登録がある場合のUsersテーブルのような役割になると思われる。
cart_itemsテーブル内にitem_idとcart_idとquantityという属性を持つ形になる。cartテーブルは主キーidとsession_idのみ。
なのでsession_idをcart_itemsに直接書けばcartテーブルいらなくね？という自分の感覚はそこまで間違ってはいないが、正規化の観点的にCartテーブルと分けた方が良いっぽい。
### CartItemsテーブル

![[スクリーンショット 2023-12-18 13.42.06.png]]

### スキーマについて
##### スキーマとは
**データベースの構造を定義したもの**

#### railsのdb/schema.rbファイルとは何か？

rails db:migrateすると db/schema.rbが更新される。

DBのスキーマをそのままキャプチャしたもの。最新のDBの状態が反映されている。

#### schema.rbの活用のされ方

DBの構造を確認したいときに、このファイルを見ればすぐにわかる。
つまりこのファイルに書いてあることが現在のDBの状態という意味になる。

##### 今のイメージ
マイグレーションファイル＝設計図
スキーマファイル＝設計図を反映させた現在の状況


#### migrationとは
データベースの構造（テーブルやカラム）を変更する時に利用する機能。
なのでマイグレーションファイル＝設計図ってのはあってそう

##### migrationの流れ
1. マイグレーションファイルを作成する
2. rails db:migrateする

これでデータベースの構造が変更される。

#### rails db:createについて
これはさらに上の話。
migrateはDBの中の構造の話で
createはそもそものDB自体を作る話。
DBもmySQLやpostgresqlなど色々あり、そういうものを指定してから
rails db:createで作成する。
